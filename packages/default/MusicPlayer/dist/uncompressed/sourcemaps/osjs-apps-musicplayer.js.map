{"version":3,"sources":["osjs-apps-musicplayer.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"../osjs-apps-musicplayer.js","sourcesContent":["define('osjs-apps-musicplayer/locales',[],function () {\n    'use strict';\n    return {\n        bg_BG: {\n            'Playlist': 'Плейлист',\n            'Playback aborted': 'Прекратено изпълнение',\n            'Network or communication error': 'Проблем с връзка към мрежа',\n            'Decoding failed. Corruption or unsupported media': 'Провалено декодиране, повереден файл или неподдържан формат',\n            'Media source not supported': 'Източника на медия не се поддържа',\n            'Failed to play file': 'Изпълнението на файла се провали',\n            'Artist': 'Изпълнител',\n            'Album': 'Албум',\n            'Track': 'Песен',\n            'Time': 'Време',\n            'Media information query failed': 'Получаване на информация провалено',\n            'seek unavailable in format': 'Невъществуващ формат',\n            'The audio type is not supported: {0}': 'Аудио формата не се поддържа'\n        },\n        de_DE: {\n            'Playlist': 'Wiedergabeliste',\n            'Playback aborted': 'Wiedergabe abgebrochen',\n            'Network or communication error': 'Netzwerk Kommunikationsfehler',\n            'Decoding failed. Corruption or unsupported media': 'Dekodierung gescheitert. Fehlerhafte oder nicht unterstützte Datei',\n            'Media source not supported': 'Medienquelle nicht unterstützt',\n            'Failed to play file': 'Wiedergabe der Datei gescheitert',\n            'Artist': 'Künstler',\n            'Album': 'Album',\n            'Track': 'Titel',\n            'Time': 'Zeit',\n            'Media information query failed': 'Media Informationssuche gescheitert',\n            'seek unavailable in format': 'Spulen im Format nicht verfügbar',\n            'The audio type is not supported: {0}': 'Der Audio-Typ {0} ist nicht unterstützt'\n        },\n        es_ES: {\n            'Playlist': 'Lista de reproducción',\n            'Playback aborted': 'Playback anulado',\n            'Network or communication error': 'Error de red o de comunicación',\n            'Decoding failed. Corruption or unsupported media': 'Fallo en el desentrelazado. Medio corrupto o no soportado',\n            'Media source not supported': 'Medio no soportado',\n            'Failed to play file': 'Error reproduciendo archivo',\n            'Artist': 'Artista',\n            'Album': 'Album',\n            'Track': 'Pista',\n            'Time': 'Tiempo',\n            'Media information query failed': 'Error recupersqndo información del medio',\n            'seek unavailable in format': 'búsqueda no disponible en este formato',\n            'The audio type is not supported: {0}': 'El tipo de audio no está soportado: {0}'\n        },\n        fr_FR: {\n            'Playlist': 'Liste de lecture',\n            'Playback aborted': 'Lecture interrompue',\n            'Network or communication error': 'Erreur de communication ou de réseau',\n            'Decoding failed. Corruption or unsupported media': 'Décodage raté. Média corrompus ou non pris en charge',\n            'Media source not supported': 'Source de médias non pris en charge',\n            'Failed to play file': 'Impossible de lire le fichier',\n            'Artist': 'Artiste',\n            'Album': 'Album',\n            'Track': 'Piste',\n            'Time': 'Durée',\n            'Media information query failed': 'Requête des informations média échoué',\n            'seek unavailable in format': 'recherche indisponible dans ce format',\n            'The audio type is not supported: {0}': \"Le type audio n'est pas pris en charge: {0}\"\n        },\n        ar_DZ: {\n            'Playlist': 'قائمة القرائة',\n            'Playback aborted': 'قطع التشغيل',\n            'Network or communication error': 'خطأ في الإتصال بالشبكة',\n            'Decoding failed. Corruption or unsupported media': 'فشل في فك التشفير. وسائط غير صالحة أو غير مدعومة',\n            'Media source not supported': 'وسائط غير مدعومة',\n            'Failed to play file': 'لايمكن قراءة الملف',\n            'Artist': 'الفنان',\n            'Album': 'الألبوم',\n            'Track': 'المقطع',\n            'Time': 'المدة',\n            'Media information query failed': 'خطأ في قراءة معلومات الوسائط',\n            'seek unavailable in format': 'بحث غير ممكن في هذا النوع',\n            'The audio type is not supported: {0}': 'نوع الملف الصوتي غير مدعوم: {0}'\n        },\n        it_IT: {\n            'Playlist': 'Playlist',\n            'Playback aborted': 'Riproduzione terminata',\n            'Network or communication error': 'Errore di rete o di comunicazione',\n            'Decoding failed. Corruption or unsupported media': 'Decodifica fallita. Supporto corroto o non supportato.',\n            'Media source not supported': 'Sorgente multimediale non supportata',\n            'Failed to play file': 'Riproduzione file fallita',\n            'Artist': 'Artista',\n            'Album': 'Album',\n            'Track': 'Traccia',\n            'Time': 'Tempo',\n            'Media information query failed': 'Recupero informazioni media fallita',\n            'seek unavailable in format': 'ricerca non disponibile nel formato',\n            'The audio type is not supported: {0}': 'Tipo di audio non supportato: {0}'\n        },\n        ko_KR: {\n            'Playlist': '재생목록',\n            'Playback aborted': '일시중지',\n            'Network or communication error': '네트워크 등 통신 문제가 발생했습니다',\n            'Decoding failed. Corruption or unsupported media': '디코딩에 실패했습니다. 손상되었거나 지원하지 않는 형식입니다',\n            'Media source not supported': '지원하지 않는 미디어 소스입니다',\n            'Failed to play file': '파일을 재생하는데 실패했습니다',\n            'Artist': '아티스트',\n            'Album': '앨범',\n            'Track': '트랙',\n            'Time': '시간',\n            'Media information query failed': '미디어 정보 조회에 실패했습니다',\n            'seek unavailable in format': '탐색을 지원하지 않는 형식입니다',\n            'The audio type is not supported: {0}': '이 오디오 형식은 지원하지 않습니다: {0}'\n        },\n        nl_NL: {\n            'Playlist': 'Afspeellijst',\n            'Playback aborted': 'Afspelen afgebroken',\n            'Network or communication error': 'Netwerk of communicatie fout',\n            'Decoding failed. Corruption or unsupported media': 'Decoderen mislukt: bestandstype wordt niet ondersteund',\n            'Media source not supported': 'Mediabron wordt niet ondersteund',\n            'Failed to play file': 'Afspelen van bestand mislukt',\n            'Artist': 'Artiest',\n            'Album': 'Album',\n            'Track': 'Nummer',\n            'Time': 'Tijd',\n            'Media information query failed': 'Zoeken naar media is niet gelukt',\n            'seek unavailable in format': 'Voor/achteruit spoelen is niet beschikbaar in dit formaat',\n            'The audio type is not supported: {0}': 'Audio type {0} wordt niet ondersteund'\n        },\n        no_NO: {\n            'Playlist': 'Spilleliste',\n            'Playback aborted': 'Avspilling avbrutt',\n            'Network or communication error': 'Nettverks- eller kommunikasjonsfeil',\n            'Decoding failed. Corruption or unsupported media': 'Dekoding feilet. Korrupt eller ustøttet media',\n            'Media source not supported': 'Media-kilde ikke støttet',\n            'Failed to play file': 'Klarte ikke spille av fil',\n            'Artist': 'Artist',\n            'Album': 'Album',\n            'Track': 'Låt',\n            'Time': 'Tid',\n            'Media information query failed': 'Media-informasjon forespursel feil',\n            'seek unavailable in format': 'spoling utilgjenglig i format',\n            'The audio type is not supported: {0}': 'Denne lyd-typen er ikke støttet: {0}'\n        },\n        pl_PL: {\n            'Playlist': 'Playlista',\n            'Playback aborted': 'Odtwarzanie Przerwane',\n            'Network or communication error': 'Błąd Sieci lub Komunikacji',\n            'Decoding failed. Corruption or unsupported media': 'Dekodowanie nie powiodło się. Uszkodzony lub nieobsługiwany plik',\n            'Media source not supported': 'Plik nie jest wspierany',\n            'Failed to play file': 'Nie można odtworzyć pliku',\n            'Artist': 'Artysta',\n            'Album': 'Album',\n            'Track': 'Ścieżka',\n            'Time': 'Czas',\n            'Media information query failed': 'Brak informacji',\n            'seek unavailable in format': 'Przewijanie nie jest obsługiwane w tym formacie',\n            'The audio type is not supported: {0}': 'Ten typ audio nie jest obsługiwany: {0}'\n        },\n        ru_RU: {\n            'Playlist': 'Список воспроизведения',\n            'Playback aborted': 'Воспроизведение прервано',\n            'Network or communication error': 'Ошибка соединения',\n            'Decoding failed. Corruption or unsupported media': 'Не удалось декодировать файл. Файл поврежден или данынй формат не поддерживается',\n            'Media source not supported': 'Тип файла не поддерживается',\n            'Failed to play file': 'Ошибка воспроизведения',\n            'Artist': 'Артист',\n            'Album': 'Альбом',\n            'Track': 'Трек',\n            'Time': 'Время',\n            'Media information query failed': 'Ошибка в запросе медиа-информации',\n            'seek unavailable in format': 'Перемотка недоступна в этом формате',\n            'The audio type is not supported: {0}': 'Тип аудио не поддерживается: {0}'\n        },\n        sk_SK: {\n            'Playlist': 'Zoznam skladieb',\n            'Playback aborted': 'Prehrávanie prerušené',\n            'Network or communication error': 'Chyba v sieťovej komunikácii',\n            'Decoding failed. Corruption or unsupported media': 'Dekódovanie sa nepodarilo alebo médium je nepodporované',\n            'Media source not supported': 'Zdrojové médium nie je podporované',\n            'Failed to play file': 'Chyba pri prehrávaní súboru',\n            'Artist': 'Umelec',\n            'Album': 'Album',\n            'Track': 'Skladba',\n            'Time': 'Čas',\n            'Media information query failed': 'Chyba pri získavaní informácii o médiu',\n            'seek unavailable in format': 'Formát média nepodporuje preskakovanie (seek)',\n            'The audio type is not supported: {0}': 'Nepodporovaný formát: {0}'\n        },\n        tr_TR: {\n            'Playlist': 'Oynatma listesi',\n            'Playback aborted': 'kayıt çalma/dinleme durduruldu',\n            'Network or communication error': 'ağ veya iletişim hatası',\n            'Decoding failed. Corruption or unsupported media': 'çözümleme hatası. Bozuk veya çalışmıyor.',\n            'Media source not supported': 'medya kaynağı bulunamadı',\n            'Failed to play file': 'Oynatma hatası',\n            'Artist': 'Artist',\n            'Album': 'Album',\n            'Track': 'Parça',\n            'Time': 'zaman',\n            'Media information query failed': 'medya bilgisini elde etmede hata oluştu',\n            'seek unavailable in format': 'bu formatta ileri saramazsınız',\n            'The audio type is not supported: {0}': 'Bu format desteklenmiyor: {0}'\n        },\n        vi_VN: {\n            'Playlist': 'Danh sách phát',\n            'Playback aborted': 'Phát lại bị hủy',\n            'Network or communication error': 'Mạng hoặc thông tin liên lạc bị lỗi',\n            'Decoding failed. Corruption or unsupported media': 'Giải mã thất bại. Tập tin bị hỏng hoặc không được hỗ trợ',\n            'Media source not supported': 'Nguồn phương tiện không được hỗ trợ',\n            'Failed to play file': 'Không thể chơi tập tin',\n            'Artist': 'Ca sĩ',\n            'Album': 'Album',\n            'Track': 'Bài hát',\n            'Time': 'Thời gian',\n            'Media information query failed': 'Truy vấn thông tin tập tin thất bại',\n            'seek unavailable in format': 'không tua được trong định dạng này',\n            'The audio type is not supported: {0}': 'Loại âm thanh {0} không được hỗ trợ'\n        }\n    };\n});\ndefine('osjs-apps-musicplayer/main',['./locales'], function (Translations) {\n    'use strict';\n    const FS = OSjs.require('utils/fs');\n    const Utils = OSjs.require('utils/misc');\n    const Locales = OSjs.require('core/locales');\n    const Dialog = OSjs.require('core/dialog');\n    const FileMetadata = OSjs.require('vfs/file');\n    const DefaultApplication = OSjs.require('helpers/default-application');\n    const DefaultApplicationWindow = OSjs.require('helpers/default-application-window');\n    const doTranslate = Locales.createLocalizer(Translations);\n    function formatTime(secs) {\n        var hr = Math.floor(secs / 3600);\n        var min = Math.floor((secs - hr * 3600) / 60);\n        var sec = Math.floor(secs - hr * 3600 - min * 60);\n        if (min < 10) {\n            min = '0' + min;\n        }\n        if (sec < 10) {\n            sec = '0' + sec;\n        }\n        return min + ':' + sec;\n    }\n    class ApplicationMusicPlayerWindow extends DefaultApplicationWindow {\n        constructor(app, metadata, file) {\n            super('ApplicationMusicPlayerWindow', {\n                icon: metadata.icon,\n                title: metadata.name,\n                auto_size: true,\n                allow_drop: true,\n                allow_resize: false,\n                allow_maximize: false,\n                width: 370,\n                height: 260,\n                translator: doTranslate\n            }, app, file);\n            this.updated = 0;\n            this.seeking = false;\n        }\n        init(wm, app) {\n            const root = super.init(...arguments);\n            var self = this;\n            this._render('MusicPlayerWindow', require('osjs-scheme-loader!./scheme.html'));\n            var label = this._find('LabelTime');\n            var seeker = this._find('Seek');\n            var player = this._find('Player');\n            var audio = player.$element.firstChild;\n            this._find('ButtonStart').set('disabled', true);\n            this._find('ButtonRew').set('disabled', true);\n            var buttonPlay = this._find('ButtonPlay').set('disabled', true).on('click', function () {\n                audio.play();\n            });\n            var buttonPause = this._find('ButtonPause').set('disabled', true).on('click', function () {\n                audio.pause();\n            });\n            this._find('ButtonFwd').set('disabled', true);\n            this._find('ButtonEnd').set('disabled', true);\n            seeker.on('change', function (ev) {\n                self.seeking = false;\n                if (audio && !audio.paused) {\n                    try {\n                        audio.pause();\n                        if (ev) {\n                            audio.currentTime = ev.detail || 0;\n                        }\n                        audio.play();\n                    } catch (e) {\n                    }\n                }\n            });\n            player.on('play', function (ev) {\n                seeker.set('disabled', false);\n                buttonPause.set('disabled', false);\n                buttonPlay.set('disabled', true);\n            });\n            player.on('ended', function (ev) {\n                seeker.set('disabled', true);\n                buttonPause.set('disabled', true);\n            });\n            player.on('pause', function (ev) {\n                seeker.set('disabled', true);\n                buttonPause.set('disabled', false);\n                buttonPlay.set('disabled', false);\n            });\n            player.on('loadeddata', function (ev) {\n            });\n            player.on('timeupdate', function (ev) {\n                self.updateTime(label, seeker);\n            });\n            player.on('error', function (ev) {\n                if (!player.$element.src) {\n                    return;\n                }\n                var msg = null;\n                try {\n                    switch (ev.target.error.code) {\n                    case ev.target.error.MEDIA_ERR_ABORTED:\n                        msg = doTranslate('Playback aborted');\n                        break;\n                    case ev.target.error.MEDIA_ERR_NETWORK:\n                        msg = doTranslate('Network or communication error');\n                        break;\n                    case ev.target.error.MEDIA_ERR_DECODE:\n                        msg = doTranslate('Decoding failed. Corruption or unsupported media');\n                        break;\n                    case ev.target.error.MEDIA_ERR_SRC_NOT_SUPPORTED:\n                        msg = doTranslate('Media source not supported');\n                        break;\n                    default:\n                        msg = Locales._('ERR_APP_UNKNOWN_ERROR');\n                        break;\n                    }\n                } catch (e) {\n                    msg = Locales._('ERR_GENERIC_APP_FATAL_FMT', e);\n                }\n                if (msg) {\n                    Dialog.create('Alert', {\n                        title: self._title,\n                        message: msg\n                    }, null, self);\n                }\n            });\n            return root;\n        }\n        showFile(file, content) {\n            if (!file || !content) {\n                return;\n            }\n            var self = this;\n            var player = this._find('Player');\n            var seeker = this._find('Seek');\n            var audio = player.$element.firstChild;\n            seeker.on('mousedown', function () {\n                self.seeking = true;\n            });\n            seeker.on('mouseup', function () {\n                self.seeking = false;\n            });\n            var artist = file ? file.filename : '';\n            var album = file ? FS.dirname(file.path) : '';\n            var labelArtist = this._find('LabelArtist').set('value', '');\n            var labelTitle = this._find('LabelTitle').set('value', artist);\n            var labelAlbum = this._find('LabelAlbum').set('value', album);\n            this._find('LabelTime').set('value', '');\n            seeker.set('min', 0);\n            seeker.set('max', 0);\n            seeker.set('value', 0);\n            this.updated = 0;\n            this.seeking = false;\n            function getInfo() {\n                self._app._api('info', { filename: file.path }).then(info => {\n                    if (info) {\n                        if (info.Artist) {\n                            labelArtist.set('value', info.Artist);\n                        }\n                        if (info.Album) {\n                            labelAlbum.set('value', info.Album);\n                        }\n                        if (info.Title) {\n                            labelTitle.set('value', info.Track);\n                        }\n                    }\n                });\n            }\n            audio.src = content || '';\n            audio.play();\n            getInfo();\n        }\n        updateTime(label, seeker) {\n            if (this._destroyed) {\n                return;\n            }\n            var player = this._find('Player');\n            var audio = player.$element.firstChild;\n            var total = audio.duration;\n            var current = audio.currentTime;\n            var unknown = false;\n            if (isNaN(current) || !isFinite(current)) {\n                current = 0;\n            }\n            if (isNaN(total) || !isFinite(total)) {\n                total = current;\n                unknown = true;\n            }\n            var time = Utils.format('{0} / {1}', formatTime(current), unknown ? '<unknown>' : formatTime(total));\n            if (this.updated < 2) {\n                seeker.set('min', 0);\n                seeker.set('max', total);\n            } else {\n                this.updated++;\n            }\n            label.set('value', time);\n            if (!this.seeking) {\n                seeker.set('value', current);\n            }\n        }\n    }\n    class ApplicationMusicPlayer extends DefaultApplication {\n        constructor(args, metadata) {\n            super('ApplicationMusicPlayer', args, metadata, { readData: false });\n        }\n        init(settings, metadata) {\n            super.init(...arguments);\n            const file = this._getArgument('file');\n            this._addWindow(new ApplicationMusicPlayerWindow(this, metadata, file));\n        }\n        _onMessage(msg, obj, args) {\n            super._onMessage(...arguments);\n            if (msg === 'attention' && obj && obj.file) {\n                var win = this._getMainWindow();\n                this.openFile(new FileMetadata(obj.file), win);\n            }\n        }\n    }\n    OSjs.Applications.ApplicationMusicPlayer = ApplicationMusicPlayer;\n});\ndefine('osjs-apps-musicplayer', ['osjs-apps-musicplayer/main'], function (main) { return main; });\n\n"]}