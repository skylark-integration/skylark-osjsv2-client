{"version":3,"sources":["windowswitcher.js"],"names":["define","DOM","OSjs","require","[object Object]","this","$switcher","showing","index","winRef","_remove","parentNode","removeChild","ev","win","wm","getLastWindow","preventDefault","container","image","label","iter","height","items","$empty","document","createElement","i","_windows","length","src","_icon","innerHTML","_title","appendChild","_wid","push","element","body","style","marginTop","console","debug","className","_focus"],"mappings":";;;;;;;AAAAA,OAAO,WACH,aACA,MAAMC,EAAMC,KAAKC,QAAQ,aACzB,aACIC,cACIC,KAAKC,UAAY,KACjBD,KAAKE,SAAU,EACfF,KAAKG,OAAS,EACdH,KAAKI,OAAS,KAElBL,UACIC,KAAKK,UAETN,UACQC,KAAKC,YACDD,KAAKC,UAAUK,YACfN,KAAKC,UAAUK,WAAWC,YAAYP,KAAKC,WAE/CD,KAAKC,UAAY,MAGzBF,KAAKS,EAAIC,EAAKC,GACVD,EAAMA,GAAOC,EAAGC,gBAChBH,EAAGI,iBACH,IAQIC,EAAWC,EAAOC,EAAOC,EARzBC,EAAS,EACTC,KACAf,EAAQ,EACPH,KAAKC,UAGNL,EAAIuB,OAAOnB,KAAKC,WAFhBD,KAAKC,UAAYmB,SAASC,cAAc,0BAK5C,IAAK,IAAIC,EAAI,EAAGA,EAAIZ,EAAGa,SAASC,OAAQF,KACpCN,EAAON,EAAGa,SAASD,MAEfT,EAAYO,SAASC,cAAc,QACnCP,EAAQM,SAASC,cAAc,QACzBI,IAAMT,EAAKU,OACjBX,EAAQK,SAASC,cAAc,SACzBM,UAAYX,EAAKY,OACvBf,EAAUgB,YAAYf,GACtBD,EAAUgB,YAAYd,GACtBf,KAAKC,UAAU4B,YAAYhB,GAC3BI,GAAU,GACNR,GAAOA,EAAIqB,OAASd,EAAKc,OACzB3B,EAAQmB,GAEZJ,EAAMa,MACFC,QAASnB,EACTJ,IAAKO,KAIZhB,KAAKC,UAAUK,YAChBc,SAASa,KAAKJ,YAAY7B,KAAKC,WAEnCD,KAAKC,UAAUiC,MAAMjB,OAASA,EAAS,KACvCjB,KAAKC,UAAUiC,MAAMC,WAAalB,IAAWA,EAAS,GAAK,GAAK,GAAK,KACjEjB,KAAKE,SACLF,KAAKG,QACDH,KAAKG,MAAQe,EAAMM,OAAS,IAC5BxB,KAAKG,OAAS,KAGlBH,KAAKG,MAAQA,EACbH,KAAKE,SAAU,GAEnBkC,QAAQC,MAAM,yBAA0BrC,KAAKG,OACzCe,EAAMlB,KAAKG,QACXe,EAAMlB,KAAKG,OAAO6B,QAAQM,UAAY,SACtCtC,KAAKI,OAASc,EAAMlB,KAAKG,OAAOM,KAEhCT,KAAKI,OAAS,KAGtBL,KAAKS,EAAIC,EAAKC,GACLV,KAAKE,UAGVM,EAAGI,iBACHZ,KAAKK,WACLI,EAAMT,KAAKI,QAAUK,IAEjBA,EAAI8B,SAERvC,KAAKI,OAAS,KACdJ,KAAKG,OAAS,EACdH,KAAKE,SAAU","file":"../windowswitcher.js","sourcesContent":["define(function () {\n    'use strict';\n    const DOM = OSjs.require('utils/dom');\n    return class WindowSwitcher {\n        constructor() {\n            this.$switcher = null;\n            this.showing = false;\n            this.index = -1;\n            this.winRef = null;\n        }\n        destroy() {\n            this._remove();\n        }\n        _remove() {\n            if (this.$switcher) {\n                if (this.$switcher.parentNode) {\n                    this.$switcher.parentNode.removeChild(this.$switcher);\n                }\n                this.$switcher = null;\n            }\n        }\n        show(ev, win, wm) {\n            win = win || wm.getLastWindow();\n            ev.preventDefault();\n            var height = 0;\n            var items = [];\n            var index = 0;\n            if (!this.$switcher) {\n                this.$switcher = document.createElement('corewm-window-switcher');\n            } else {\n                DOM.$empty(this.$switcher);\n            }\n            var container, image, label, iter;\n            for (var i = 0; i < wm._windows.length; i++) {\n                iter = wm._windows[i];\n                if (iter) {\n                    container = document.createElement('div');\n                    image = document.createElement('img');\n                    image.src = iter._icon;\n                    label = document.createElement('span');\n                    label.innerHTML = iter._title;\n                    container.appendChild(image);\n                    container.appendChild(label);\n                    this.$switcher.appendChild(container);\n                    height += 32;\n                    if (win && win._wid === iter._wid) {\n                        index = i;\n                    }\n                    items.push({\n                        element: container,\n                        win: iter\n                    });\n                }\n            }\n            if (!this.$switcher.parentNode) {\n                document.body.appendChild(this.$switcher);\n            }\n            this.$switcher.style.height = height + 'px';\n            this.$switcher.style.marginTop = (height ? -(height / 2 << 0) : 0) + 'px';\n            if (this.showing) {\n                this.index++;\n                if (this.index > items.length - 1) {\n                    this.index = -1;\n                }\n            } else {\n                this.index = index;\n                this.showing = true;\n            }\n            console.debug('WindowSwitcher::show()', this.index);\n            if (items[this.index]) {\n                items[this.index].element.className = 'Active';\n                this.winRef = items[this.index].win;\n            } else {\n                this.winRef = null;\n            }\n        }\n        hide(ev, win, wm) {\n            if (!this.showing) {\n                return;\n            }\n            ev.preventDefault();\n            this._remove();\n            win = this.winRef || win;\n            if (win) {\n                win._focus();\n            }\n            this.winRef = null;\n            this.index = -1;\n            this.showing = false;\n        }\n    };\n});"]}