/**
 * osjs-apps-corewm - 
 * @author 
 * @version v1.0.0
 * @link 
 * @license 
 */
define(["../panelitem"],function(e){"use strict";const t=OSjs.require("utils/gui"),n=OSjs.require("utils/dom"),i=OSjs.require("utils/events"),s=OSjs.require("core/window-manager");return class extends e{constructor(){super("PanelItemWindowList corewm-panel-expand"),this.entries=[]}init(){const e=super.init(...arguments),t=s.instance;if(t){const e=t.getWindows();for(let t=0;t<e.length;t++)e[t]&&this.update("create",e[t])}return e}destroy(){return this.entries.forEach(function(e){try{e.destroy()}catch(e){}e=null}),this.entries=[],super.destroy(...arguments)}update(e,s){if(!this._$container||s&&!1===s._properties.allow_windowlist)return;let o=null;if("create"===e){const e="corewm-panel-ellipsis WindowList_Window_"+s._wid;if(this._$container.getElementsByClassName(e).length)return;o=new class{constructor(e,n){const s=document.createElement("li");s.className=n,s.title=e._title,s.setAttribute("role","button"),s.setAttribute("aria-label",e._title);const o=document.createElement("img");o.alt=e._title,o.src=e._icon;const c=document.createElement("span");c.appendChild(document.createTextNode(e._title)),s.appendChild(o),s.appendChild(c),i.$bind(s,"click",function(){e._restore(!1,!0)}),i.$bind(s,"contextmenu",function(t){return t.preventDefault(),e&&e._onWindowIconClick(t,this),!1});let r=!1;t.createDroppable(s,{onDrop:function(t,n){e&&e._focus()},onLeave:function(){r&&(r=!1)},onEnter:function(t,n,i){r||(e&&e._focus(),r=!0)},onItemDropped:function(t,n,i,s){return!!e&&e._onDndEvent(t,"itemDrop",i,s)},onFilesDropped:function(t,n,i,s){return!!e&&e._onDndEvent(t,"filesDrop",i,s)}}),e._state.focused&&(s.className+=" Focused"),this.$element=s,this.id=e._wid}destroy(){this.$element&&(i.$unbind(this.$element,"click"),i.$unbind(this.$element,"contextmenu"),this.$element=n.$remove(this.$element))}event(e,t,i){const s="WindowList_Window_"+t._wid;function o(e,t){const n=i.getElementsByClassName(e);if(n.length)for(let e=0,i=n.length;e<i;e++)n[e]&&n[e].parentNode&&t(n[e])}if("focus"===e)o(s,function(e){e.className+=" Focused"});else if("blur"===e)o(s,function(e){e.className=e.className.replace(/\s?Focused/,"")});else if("title"===e)o(s,function(e){e.setAttribute("aria-label",t._title);const i=e.getElementsByTagName("span")[0];i&&(n.$empty(i),i.appendChild(document.createTextNode(t._title)));const s=e.getElementsByTagName("img")[0];s&&(s.alt=t._title)});else if("icon"===e)o(s,function(e){e.getElementsByTagName("img")[0].src=t._icon});else if("attention_on"===e)o(s,function(e){e.className.match(/Attention/)||(e.className+=" Attention")});else if("attention_off"===e)o(s,function(e){e.className.match(/Attention/)||(e.className=e.className.replace(/\s?Attention/,""))});else if("close"===e)return!1;return!0}}(s,e),this.entries.push(o),this._$container.appendChild(o.$element)}else{let t=-1;this.entries.forEach(function(e,n){return e.id===s._wid&&(t=n),-1!==t}),(o=this.entries[t])&&!1===o.event(e,s,this._$container)&&(o.destroy(),this.entries.splice(t,1))}}}});
//# sourceMappingURL=../sourcemaps/panelitems/windowlist.js.map
