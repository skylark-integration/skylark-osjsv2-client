/**
 * osjs-apps-corewm - 
 * @author 
 * @version v1.0.0
 * @link 
 * @license 
 */
define(["./locales"],function(e){"use strict";const t=OSjs.require("core/locales").createLocalizer(e),n=OSjs.require("gui/menu"),i=OSjs.require("utils/gui"),o=OSjs.require("utils/dom"),a=OSjs.require("utils/events"),r=OSjs.require("core/process"),c=OSjs.require("core/theme"),s=OSjs.require("core/window-manager"),l=OSjs.require("core/package-manager");class u{constructor(){var e=l.getPackages(),n=s.instance.getDefaultSetting("menu");function o(e){return function(t){i.createDraggable(t,{type:"application",data:{launch:e.name}})}}function a(e){return function(){r.create(e.name)}}var u={};Object.keys(n).forEach(function(e){u[e]=[]}),Object.keys(e).forEach(function(t){var n=e[t];if("application"===n.type&&!1!==n.visible){var i=n.category&&u[n.category]?n.category:"unknown";u[i].push({name:t,data:n})}});var m=[];Object.keys(u).forEach(function(e){for(var i=[],r=0;r<u[e].length;r++){var s=u[e][r];i.push({title:s.data.name,icon:c.getIcon(s.data.icon,"16x16"),tooltip:s.data.description,onCreated:o(s),onClick:a(s)})}i.length&&m.push({title:t(n[e].title),icon:c.getIcon(n[e].icon,"16x16"),menu:i})}),this.list=m}show(e){var t=n.create(this.list,e);t&&t.$element&&o.$addClass(t.$element,"CoreWMDefaultApplicationMenu")}}class m{constructor(){var e=this.$element=document.createElement("gui-menu");this.$element.id="CoreWMApplicationMenu";var t=l.getPackages();Object.keys(t).forEach(function(n){var i=t[n];"application"===i.type&&!1!==i.visible&&function(t,n){var i=document.createElement("gui-menu-entry"),o=document.createElement("img");o.src=c.getIcon(n.icon,"32x32");var s=document.createElement("div");s.appendChild(document.createTextNode(n.name)),a.$bind(i,"click",function(e){r.create(t)}),i.appendChild(o),i.appendChild(s),e.appendChild(i)}(n,i)})}destroy(){this.$element&&(this.$element.querySelectorAll("gui-menu-entry").forEach(function(e){a.$unbind(e,"click")}),o.$remove(this.$element)),this.$element=null}show(e){this.$element&&(this.$element.parentNode||document.body.appendChild(this.$element),o.$removeClass(this.$element,"AtBottom"),o.$removeClass(this.$element,"AtTop"),e.y>window.innerHeight/2?(o.$addClass(this.$element,"AtBottom"),this.$element.style.top="auto",this.$element.style.bottom="30px"):(o.$addClass(this.$element,"AtTop"),this.$element.style.bottom="auto",this.$element.style.top="30px"),this.$element.style.left=e.x+"px")}getRoot(){return this.$element}}return{showMenu:function(e){const t=s.instance;let i;if(t&&!0===t.getSetting("useTouchMenu")){i=new m;var a={x:e.clientX,y:e.clientY};if(e.target){var r=o.$position(e.target,document.body);if(r.left&&r.top&&r.width&&r.height){a.x=r.left-r.width/2,a.x<=16&&(a.x=0);var c=o.$parent(e.target,function(e){return"corewm-panel"===e.tagName.toLowerCase()});if(c){var l=o.$position(c);a.y=l.top+l.height}else a.y=r.top+r.height}}n.create(null,a,i)}else(i=new u).show(e)}}});
//# sourceMappingURL=sourcemaps/menu.js.map
