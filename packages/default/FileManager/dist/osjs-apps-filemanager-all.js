/**
 * osjs-apps-filemanager - 
 * @author 
 * @version v1.0.0
 * @link 
 * @license 
 */
!function(e,n){var i=n.define,require=n.require,t="function"==typeof i&&i.amd,a=!t&&"undefined"!=typeof exports;if(!t&&!i){var r={};i=n.define=function(e,n,i){"function"==typeof i?(r[e]={factory:i,deps:n.map(function(n){return function(e,n){if("."!==e[0])return e;var i=n.split("/"),t=e.split("/");i.pop();for(var a=0;a<t.length;a++)"."!=t[a]&&(".."==t[a]?i.pop():i.push(t[a]));return i.join("/")}(n,e)}),resolved:!1,exports:null},require(e)):r[e]={factory:null,resolved:!0,exports:i}},require=n.require=function(e){if(!r.hasOwnProperty(e))throw new Error("Module "+e+" has not been defined");var module=r[e];if(!module.resolved){var i=[];module.deps.forEach(function(e){i.push(require(e))}),module.exports=module.factory.apply(n,i)||null,module.resolved=!0}return module.exports}}if(!i)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(e,require){e("osjs-apps-filemanager/locales",[],function(){"use strict";return{bg_BG:{"Copying file...":"Копиране на файл...","Copying **{0}** to **{1}**":"Копиране **{0}** към **{1}**","Refreshing...":"Опресняване...","Loading...":"Зареждане...","Create a new directory in **{0}**":"Създаване на нова директория в **{0}**","Rename **{0}**":"преименуване на **{0}**","Delete **{0}** ?":"Изтриване на **{0}**?"},de_DE:{"Copying file...":"Kopiere Datei...","Copying **{0}** to **{1}**":"Kopiere **{0}** nach **{1}**","Refreshing...":"Aktualisiere...","Loading...":"Lade...","Create a new directory in **{0}**":"Erstelle ein neues Verzeichnis in **{0}**","Rename **{0}**":"**{0}** umbenennen","Delete **{0}** ?":"**{0}** löschen?"},fr_FR:{"Copying file...":"Copie de fichier...","Copying **{0}** to **{1}**":"Copie de **{0}** à **{1}**","Refreshing...":"Rafraichissement...","Loading...":"Chargement...","Create a new file in **{0}**":"Créer un nouveau fichier dans **{0}**","Create a new directory in **{0}**":"Créer un nouveau dossier dans **{0}**","Rename **{0}**":"Renommer **{0}**","Delete **{0}** ?":"Supprimer **{0}** ?","Selected {0} files, {1} dirs, {2}":"{0} fichier(s) selectionné(s), {1} dossier(s), {2}","Showing {0} files ({1} hidden), {2} dirs, {3}":"{0} fichier(s) affiché(s) ({1} caché(s)), {2} dossier(s), {3}"},ar_DZ:{"Copying file...":"جاري نسخ الملف...","Copying **{0}** to **{1}**":"نسخ من **{0}** إلى **{1}**","Refreshing...":"جاري التحديث...","Loading...":"جاري التحميل...","Create a new file in **{0}**":"إنشاء ملف جديد في **{0}**","Create a new directory in **{0}**":"إنشاء مجلد جديد في **{0}**","Rename **{0}**":"إعادة التسمية **{0}**","Delete **{0}** ?":"حذف **{0}** ?","Selected {0} files, {1} dirs, {2}":"{0} ملف مختار, {1} مجلد, {2}","Showing {0} files ({1} hidden), {2} dirs, {3}":"{0} ملف مرئي ({1} مخفي(s)), {2} مجلد, {3}"},it_IT:{"Copying file...":"Copiamento file...","Copying **{0}** to **{1}**":"Copia **{0}** in **{1}**","Refreshing...":"Ricarica...","Loading...":"Caricamento...","Create a new file in **{0}**":"Creazione nuovo file in **{0}**","Create a new directory in **{0}**":"Creazione nuova cartella in **{0}**","Rename **{0}**":"Rinomina **{0}**","Delete **{0}** ?":"Cancellare **{0}** ?","Selected {0} files, {1} dirs, {2}":"{0} file selezionati, {1} cartelle, {2}","Showing {0} files ({1} hidden), {2} dirs, {3}":"Mostrando {0} file(s) ({1} nascosti), {2} cartelle, {3}"},ko_KR:{"Copying file...":"파일 복사...","Copying **{0}** to **{1}**":"**{0}**를 **{1}**으로 복사","Refreshing...":"새로고치는 중...","Loading...":"기다려주세요...","Create a new file in **{0}**":"**{0}**에 새 파일 만들기","Create a new directory in **{0}**":"**{0}**에 새 디렉토리 만들기","Rename **{0}**":"**{0}**의 이름 바꾸기","Delete **{0}** ?":"**{0}**을 삭제하시겠습니까?","Selected {0} files, {1} dirs, {2}":"{0} 개의 파일, {1} 개의 디렉토리가 선택됨, {2}","Showing {0} files ({1} hidden), {2} dirs, {3}":"{0} 개의 파일({1} 개의 숨긴 파일), {2} 개의 디렉토리가 존재, {3}"},nl_NL:{"Copying file...":"Bestand kopieren...","Copying **{0}** to **{1}**":"Kopieer **{0}** naar **{1}**","Refreshing...":"Vernieuwen...","Loading...":"Laden...","Create a new directory in **{0}**":"Maak een nieuwe map in **{0}**","Rename **{0}**":"Hernoem **{0}**","Delete **{0}** ?":"**{0}** verwijderen?"},no_NO:{"Copying file...":"Kopierer fil...","Copying **{0}** to **{1}**":"Kopierer **{0}** to **{1}**","Refreshing...":"Gjenoppfrisker...","Loading...":"Laster...","Create a new file in **{0}**":"Opprett ny fil i **{0}**","Create a new directory in **{0}**":"Opprett ny mappe i **{0}**","Rename **{0}**":"Navngi **{0}**","Delete **{0}** ?":"Slette **{0}** ?"},pl_PL:{"Copying file...":"Kopiowanie pliku...","Copying **{0}** to **{1}**":"Kopiowanie **{0}** do **{1}**","Refreshing...":"Odświeżanie...","Loading...":"Ładowanie...","Create a new file in **{0}**":"Utwórz nowy plik w **{0}**","Create a new directory in **{0}**":"Utwórz nowy folder w **{0}**","Rename **{0}**":"Zmień nazwę **{0}**","Delete **{0}** ?":"Usunąć **{0}** ?","Selected {0} files, {1} dirs, {2}":"Wybrane pliki: {0}, foldery: {1}, {2}","Showing {0} files ({1} hidden), {2} dirs, {3}":"Pokazywane pliki: {0} /(ukryte: {1}, foldery: {2}, {3}"},ru_RU:{"Copying file...":"Копирование файла...","Copying **{0}** to **{1}**":"Копирование **{0}** в **{1}**","Refreshing...":"Обновление...","Loading...":"Загрузка...","Create a new directory in **{0}**":"Создать новый каталог в **{0}**","Rename **{0}**":"Переименовать **{0}**","Delete **{0}** ?":"Удалить **{0}** ?"},sk_SK:{"Copying file...":"Kopírujem súbor...","Copying **{0}** to **{1}**":"Kopírujem **{0}** do **{1}**","Refreshing...":"Obnovujem...","Loading...":"Nahrávam...","Create a new file in **{0}**":"Vytvor nový súbor v **{0}**","Create a new directory in **{0}**":"Vytvor nový adresár v **{0}**","Rename **{0}**":"Premenuj **{0}**","Delete **{0}** ?":"Zmazať **{0}** ?"},tr_TR:{"Copying file...":"kopyalanıyor...","Copying **{0}** to **{1}**":"**{0}** dosyası  **{1}**e kopyalanıyor","Refreshing...":"yenileniyor...","Loading...":"yükleniyor...","Create a new directory in **{0}**":" **{0}** içinde yeni bir klasör aç","Rename **{0}**":"yeniden adlandır **{0}**","Delete **{0}** ?":"sil **{0}**?"},vi_VN:{"Copying file...":"Đang sao chép...","Copying **{0}** to **{1}**":"Đang chép **{0}** tới **{1}**","Refreshing...":"Đang làm mới...","Loading...":"Đang tải...","Create a new file in **{0}**":"Tạo một tập tin mới trong **{0}**","Create a new directory in **{0}**":"Tạo một thư mục mới trong **{0}**","Rename **{0}**":"Đổi tên **{0}**","Delete **{0}** ?":"Xóa **{0}**?","Selected {0} files, {1} dirs, {2}":"Đã chọn {0} tập tin, {1} thư mục, {2}","Showing {0} files ({1} hidden), {2} dirs, {3}":"Đang hiển thị {0} tập tin({1} bị ẩn), {2} thư mục, {3}"}}}),e("osjs-apps-filemanager/scheme.html",[],function(){return'<application-window data-id="FileManagerWindow">\r\n\r\n  <gui-vbox>\r\n    \x3c!-- MENU BAR --\x3e\r\n    <gui-vbox-container data-grow="0" data-shrink="1" data-basis="auto">\r\n      <gui-menu-bar>\r\n\r\n        <gui-menu-bar-entry data-label="LBL_FILE">\r\n          <gui-menu data-id="SubmenuFile">\r\n            <gui-menu-entry data-id="MenuCreate" data-label="LBL_CREATE">\r\n              <gui-menu data-id="SubmenuCreate">\r\n                <gui-menu-entry data-id="MenuCreateDirectory" data-label="LBL_DIRECTORY"></gui-menu-entry>\r\n                <gui-menu-entry data-id="MenuCreateFile" data-label="LBL_FILE"></gui-menu-entry>\r\n              </gui-menu>\r\n            </gui-menu-entry>\r\n\r\n            <gui-menu-entry data-id="MenuUpload" data-label="LBL_UPLOAD"></gui-menu-entry>\r\n            <gui-menu-entry data-id="MenuClose" data-label="LBL_CLOSE"></gui-menu-entry>\r\n          </gui-menu>\r\n        </gui-menu-bar-entry>\r\n\r\n        <gui-menu-bar-entry data-label="LBL_EDIT">\r\n          <gui-menu data-id="SubmenuEdit">\r\n            <gui-menu-entry data-id="MenuRename" data-label="LBL_RENAME"></gui-menu-entry>\r\n            <gui-menu-entry data-id="MenuDelete" data-label="LBL_DELETE"></gui-menu-entry>\r\n            <gui-menu-entry data-id="MenuInfo" data-label="LBL_INFORMATION"></gui-menu-entry>\r\n            <gui-menu-entry data-id="MenuOpen" data-label="LBL_OPENWITH"></gui-menu-entry>\r\n            <gui-menu-entry data-id="MenuDownload" data-label="LBL_DOWNLOAD_COMP"></gui-menu-entry>\r\n          </gui-menu>\r\n        </gui-menu-bar-entry>\r\n\r\n        <gui-menu-bar-entry data-label="LBL_VIEW">\r\n          <gui-menu data-id="SubmenuView">\r\n            <gui-menu-entry data-id="MenuRefresh" data-label="LBL_REFRESH"></gui-menu-entry>\r\n            <gui-menu-entry data-id="MenuShowSidebar" data-label="LBL_SHOW_SIDEBAR" data-type="checkbox"></gui-menu-entry>\r\n            <gui-menu-entry data-id="MenuShowNavigation" data-label="LBL_SHOW_NAVIGATION" data-type="checkbox"></gui-menu-entry>\r\n            <gui-menu-entry data-id="MenuShowHidden" data-label="LBL_SHOW_HIDDENFILES" data-type="checkbox"></gui-menu-entry>\r\n            <gui-menu-entry data-id="MenuShowExtension" data-label="LBL_SHOW_FILEEXTENSIONS" data-type="checkbox"></gui-menu-entry>\r\n            <gui-menu-entry data-id="" data-label="LBL_VIEWTYPE">\r\n              <gui-menu>\r\n                <gui-menu-entry data-id="MenuViewList" data-label="LBL_LISTVIEW" data-type="radio" data-group="ViewType"></gui-menu-entry>\r\n                <gui-menu-entry data-id="MenuViewIcon" data-label="LBL_ICONVIEW" data-type="radio" data-group="ViewType"></gui-menu-entry>\r\n                <gui-menu-entry data-id="MenuViewTree" data-label="LBL_TREEVIEW" data-type="radio" data-group="ViewType"></gui-menu-entry>\r\n              </gui-menu>\r\n            </gui-menu-entry>\r\n            <gui-menu-entry data-id="" data-label="LBL_SHOW_COLUMNS">\r\n              <gui-menu>\r\n                <gui-menu-entry data-id="MenuColumnFilename" data-label="LBL_FILENAME" data-type="checkbox"></gui-menu-entry>\r\n                <gui-menu-entry data-id="MenuColumnMIME" data-label="LBL_MIME" data-type="checkbox"></gui-menu-entry>\r\n                <gui-menu-entry data-id="MenuColumnCreated" data-label="LBL_CREATED" data-type="checkbox"></gui-menu-entry>\r\n                <gui-menu-entry data-id="MenuColumnModified" data-label="LBL_MODIFIED" data-type="checkbox"></gui-menu-entry>\r\n                <gui-menu-entry data-id="MenuColumnSize" data-label="LBL_SIZE" data-type="checkbox"></gui-menu-entry>\r\n              </gui-menu>\r\n            </gui-menu-entry>\r\n          </gui-menu>\r\n        </gui-menu-bar-entry>\r\n        \x3c!-- CONTEXT MENU --\x3e\r\n        <gui-menu-bar-entry data-id="ContextMenu" data-label="LBL_CONTEXT">\r\n            <gui-menu data-id="SubmenuContext">\r\n              <gui-menu-entry data-id="MenuCreate" data-label="LBL_CREATE">\r\n            <gui-menu data-id="SubmenuCreate">\r\n              <gui-menu-entry data-id="MenuCreateDirectory" data-label="LBL_DIRECTORY" data-func="MenuCreateDirectory"></gui-menu-entry>\r\n              <gui-menu-entry data-id="MenuCreateFile" data-label="LBL_FILE" data-func="MenuCreateFile"></gui-menu-entry>\r\n            </gui-menu>\r\n            </gui-menu-entry>\r\n            <gui-menu-entry data-id="ContextMenuUpload" data-label="LBL_UPLOAD" data-func="MenuUpload"></gui-menu-entry>\r\n            <gui-menu-entry data-id="ContextMenuRename" data-label="LBL_RENAME" data-func="MenuRename"></gui-menu-entry>\r\n            <gui-menu-entry data-id="ContextMenuDelete" data-label="LBL_DELETE" data-func="MenuDelete"></gui-menu-entry>\r\n            <gui-menu-entry data-id="ContextMenuInfo" data-label="LBL_INFORMATION" data-func="MenuInfo"></gui-menu-entry>\r\n            <gui-menu-entry data-id="ContextMenuOpen" data-label="LBL_OPENWITH" data-func="MenuOpen"></gui-menu-entry>\r\n            <gui-menu-entry data-id="ContextMenuDownload" data-label="LBL_DOWNLOAD_COMP" data-func="MenuDownload"></gui-menu-entry>\r\n          </gui-menu>\r\n        </gui-menu-bar-entry>\r\n    </gui-menu-bar>\r\n  </gui-vbox-container>\r\n\r\n    \x3c!-- TOOLBAR --\x3e\r\n    <gui-vbox-container data-grow="0" data-shrink="1" data-basis="auto" data-id="ToolbarContainer">\r\n      <gui-toolbar data-id="TopToolbar" class="gui-flex">\r\n\r\n        <gui-button data-icon="stock://16x16/actions/go-previous.png" data-id="GoBack"></gui-button>\r\n        <gui-button data-icon="stock://16x16/actions/go-next.png" data-id="GoNext"></gui-button>\r\n        <gui-button data-icon="stock://16x16/devices/drive-harddisk.png" data-id="ToggleSideview"></gui-button>\r\n        <gui-text class="gui-flex-grow" data-id="GoLocation" data-placeholder="location:///path"></gui-text>\r\n\r\n      </gui-toolbar>\r\n    </gui-vbox-container>\r\n\r\n    \x3c!-- CONTENT --\x3e\r\n    <gui-vbox-container data-grow="1" data-shrink="0" data-basis="auto" data-fill="true">\r\n      <gui-paned-view data-id="PanedView">\r\n        \x3c!-- SIDE PANEL --\x3e\r\n        <gui-paned-view-container data-basis="150px" data-grow="0" data-shrink="0" data-multiple="false" data-id="SideContainer">\r\n          <gui-list-view data-id="SideView" data-single-click="true">\r\n          </gui-list-view>\r\n        </gui-paned-view-container>\r\n\r\n        \x3c!-- FILE VIEW --\x3e\r\n        <gui-paned-view-container data-grow="1" data-shrink="1">\r\n          <gui-file-view data-id="FileView">\r\n          </gui-file-view>\r\n        </gui-paned-view-container>\r\n      </gui-paned-view>\r\n    </gui-vbox-container>\r\n\r\n\r\n    \x3c!-- STATUSBAR --\x3e\r\n    <gui-vbox-container data-grow="0" data-shrink="1" data-basis="auto">\r\n      <gui-statusbar data-id="Statusbar"></gui-statusbar>\r\n    </gui-vbox-container>\r\n  </gui-vbox>\r\n\r\n</application-window>\r\n'}),e("osjs-apps-filemanager/main",["./locales","./scheme.html"],function(e,n){"use strict";const i=OSjs.require("utils/fs"),t=OSjs.require("vfs/fs"),a=OSjs.require("vfs/file"),r=OSjs.require("core/application"),o=OSjs.require("core/window"),u=OSjs.require("core/dialog"),d=OSjs.require("core/locales"),s=OSjs.require("utils/events"),l=OSjs.require("utils/misc"),c=OSjs.require("core/settings-manager"),g=OSjs.require("core/mount-manager"),h=OSjs.require("gui/element"),f=OSjs.require("utils/clipboard"),m=OSjs.require("utils/keycodes"),p=OSjs.require("core/config"),y=OSjs.require("core/theme"),w=OSjs.require("gui/notification"),_=d.createLocalizer(e);function b(e){var n=[];return(e.get("value")||[]).forEach(function(e){e.data.shortcut||n.push(e.data)}),n}function v(e,n,i){var t=e.destination,r=e.file;u.create("FileUpload",{dest:t,file:r},function(e,i,r){if("ok"!==i&&"complete"!==i)n(!1,!1);else{var o=a.fromUpload(t,r);n(!1,o)}},i)}var C={};class S extends o{constructor(e,n,t,r){super("ApplicationFileManagerWindow",{icon:n.icon,title:n.name,allow_drop:!0,width:650,height:420,translator:_},e),this.wasFileDropped=!1,this.currentPath=t,this.currentSummary={},this.viewOptions=l.argumentDefaults(r||{},{ViewNavigation:!0,ViewSide:!0},!0),this.history=[],this.historyIndex=-1;var o=this;this.settingsWatch=c.watch("VFS",function(){o._loaded&&o.changePath()}),this._on("drop:upload",function(n,i){e.upload(o.currentPath,i,o)}),this._on("drop:file",function(n,t){if(i.dirname(t.path)!==o.currentPath){var r=new a(i.pathJoin(o.currentPath,t.filename));o.wasFileDropped=r,e.copy(t,r,o)}}),this._on("keydown",function(n,t,r,u,d){if(s.keyCombination(n,"CTRL+V")){var l=f.getClipboard();l&&l instanceof Array&&l.forEach(function(n){if(n&&n instanceof a){var t=new a(i.pathJoin(o.currentPath,n.filename));e.copy(n,t,o)}})}else n.keyCode===m.DELETE&&e.rm(b(o._find("FileView")),o)}),this._on("destroy",function(){try{c.unwatch(o.settingsWatch)}catch(e){}})}init(e,i){const t=super.init(...arguments);var a,r=this,o=this.viewOptions.ViewType||"gui-list-view",u=!0===this.viewOptions.ViewSide,d=!0===this.viewOptions.ViewNavigation,s=l.cloneObject(c.get("VFS")||{}),g=s.scandir||{},h=!0===g.showHiddenFiles,f=!0===g.showFileExtensions;this._render("FileManagerWindow",n),"nw"!==p.getConfig("Connection.Type")&&window.location.protocol.match(/^file/)&&this._setWarning("VFS does not work when in standalone mode");var m={MenuClose:function(){r._close()},MenuCreateFile:function(){i.mkfile(r.currentPath,r)},MenuCreateDirectory:function(){i.mkdir(r.currentPath,r)},MenuUpload:function(){i.upload(r.currentPath,null,r)},MenuRename:function(){i.rename(b(a),r)},MenuDelete:function(){i.rm(b(a),r)},MenuInfo:function(){i.info(b(a),r)},MenuOpen:function(){i.open(b(a),r)},MenuDownload:function(){i.download(b(a),r)},MenuRefresh:function(){r.changePath()},MenuViewList:function(){r.changeView("gui-list-view",!0)},MenuViewTree:function(){r.changeView("gui-tree-view",!0)},MenuViewIcon:function(){r.changeView("gui-icon-view",!0)},MenuShowSidebar:function(){u=r.toggleSidebar(!u,!0)},MenuShowNavigation:function(){d=r.toggleNavbar(!d,!0)},MenuShowHidden:function(){h=r.toggleHidden(!h,!0)},MenuShowExtension:function(){f=r.toggleExtension(!f,!0)},MenuColumnFilename:function(){r.toggleColumn("filename",!0)},MenuColumnMIME:function(){r.toggleColumn("mime",!0)},MenuColumnCreated:function(){r.toggleColumn("ctime",!0)},MenuColumnModified:function(){r.toggleColumn("mtime",!0)},MenuColumnSize:function(){r.toggleColumn("size",!0)}};function y(e){var n=e.detail.func||e.detail.id;m[n]&&m[n]()}this._find("SubmenuFile").on("select",y);var w=this._find("SubmenuContext").on("select",y);this._find("SubmenuEdit").on("select",y);var _=this._find("SubmenuView").on("select",y);_.set("checked","MenuViewList","gui-list-view"===o),_.set("checked","MenuViewTree","gui-tree-view"===o),_.set("checked","MenuViewIcon","gui-icon-view"===o),_.set("checked","MenuShowSidebar",u),_.set("checked","MenuShowNavigation",d),_.set("checked","MenuShowHidden",h),_.set("checked","MenuShowExtension",f),this._find("GoLocation").on("enter",function(e){r.changePath(e.detail,null,!1,!0)}),this._find("GoBack").on("click",function(e){r.changeHistory(-1)}),this._find("GoNext").on("click",function(e){r.changeHistory(1)});var v=this._find("PanedView");this._find("ToggleSideview").on("click",function(e){if(v.$element){var n=v.$element.getAttribute("data-toggled");v.$element.setAttribute("data-toggled",String("true"!==n))}});var C=this._find("SideView");return C.on("activate",function(e){if(e&&e.detail&&e.detail.entries){var n=e.detail.entries[0];n&&r.changePath(n.data.root)}}),(a=this._find("FileView")).on("activate",function(e){e&&e.detail&&e.detail.entries&&r.checkActivation(e.detail.entries)}),a.on("select",function(e){e&&e.detail&&e.detail.entries&&r.checkSelection(e.detail.entries)}),a.on("contextmenu",function(e){e&&e.detail&&e.detail.entries&&r.checkSelection(e.detail.entries),w.show(e)}),this.renderSideView(),this.changeView(o,!1),this.toggleHidden(h,!1),this.toggleExtension(f,!1),this.toggleSidebar(u,!1),this.toggleNavbar(d,!1),this.changePath(this.currentPath),this.toggleColumn(),t}checkSelection(e){e=e||[];var n=this._scheme;if(n){var t,a=this,r="",o=this._find("Statusbar");if(e&&e.length){t={files:0,directories:0,size:0},e.forEach(function(e){"dir"===e.data.type?t.directories++:(t.files++,t.size+=e.data.size)});var u=1===e.length&&!0===e[0].data.shortcut;r=_("Selected {0} files, {1} dirs, {2}",t.files,t.directories,i.humanFileSize(t.size)),d(t.files,t.directories,u)}else(t=this.currentSummary)&&(r=_("Showing {0} files ({1} hidden), {2} dirs, {3}",t.files,t.hidden,t.directories,i.humanFileSize(t.size))),d(!1,!1,!1);o.set("value",r)}function d(e,n,i){var t=!e||!!n,r=!(e||n);a._find("MenuRename").set("disabled",i||r),a._find("MenuDelete").set("disabled",i||r),a._find("MenuInfo").set("disabled",r),a._find("MenuDownload").set("disabled",t),a._find("MenuOpen").set("disabled",t),a._find("ContextMenuRename").set("disabled",i||r),a._find("ContextMenuDelete").set("disabled",i||r),a._find("ContextMenuInfo").set("disabled",r),a._find("ContextMenuDownload").set("disabled",t),a._find("ContextMenuOpen").set("disabled",t)}}checkActivation(e){var n=this;(e||[]).forEach(function(e){return"dir"===e.data.type?(n.changePath(e.data.path),!1):(r.createFromFile(new a(e.data)),!0)})}updateSideView(e){if(!this._destroyed&&this._scheme){var n=null,i=this.currentPath||"/";e&&this.renderSideView(),g.getModules({special:!0}).forEach(function(e,t){i.match(e.option("match"))&&(n=e.option("root"))});var t=this._find("SideView");t.set("selected",n,"root")}}renderSideView(){if(!this._destroyed&&this._scheme){var e=[];g.getModules({special:!0}).forEach(function(n,i){var t=[n.mounted()?"mounted":"unmounted"];n.isReadOnly()&&t.push("readonly gui-has-emblem"),e.push({value:n.options,className:t.join(" "),columns:[{label:n.option("title"),icon:y.getIcon(n.option("icon"))}],onCreated:function(e){n.isReadOnly()&&(e.style.backgroundImage="url("+y.getIcon("emblems/emblem-readonly.png","16x16")+")")}})});var n=this._find("SideView");n.clear(),n.add(e)}}onMountEvent(e,n){e&&("vfs:unmount"===n&&this.currentPath.match(e.option("match"))&&this.changePath(p.getDefaultPath()),this.updateSideView(e))}onFileEvent(e,n){this.currentPath!==i.dirname(e.path)&&this.currentPath!==e.path||this.changePath(null,this.wasFileDropped,!1,!1,!this.wasFileDroped)}changeHistory(e){-1!==this.historyIndex&&(e<0?this.historyIndex>0&&this.historyIndex--:e>0&&this.historyIndex<this.history.length-1&&this.historyIndex++,this.changePath(this.history[this.historyIndex],null,!0))}changePath(e,n,i,t,a){if(!this._destroyed&&this._scheme){this.wasFileDropped=!1,e=e||this.currentPath;var r=this,o=this._find("FileView");this._toggleLoading(!0),o.chdir({path:e,done:function(u,d){!r._destroyed&&r._scheme&&(e&&!u&&(r.currentPath=e,r.currentSummary=d,r._app&&r._app._setArgument("path",e),function(e){if(!i){r.historyIndex>=0&&r.historyIndex<r.history.length-1&&(r.history=[]);var n=r.history[r.history.length-1];n!==e&&r.history.push(e),r.history.length>1?r.historyIndex=r.history.length-1:r.historyIndex=-1}t&&(r.history=[e],r.historyIndex=0);r._setTitle(e,!0)}(e)),r._toggleLoading(!1),r.checkSelection([]),r.updateSideView(),n&&o&&o.set("selected",n.filename,"filename",{scroll:a}),r._find("GoLocation").set("value",e),r._find("GoBack").set("disabled",r.historyIndex<=0),r._find("GoNext").set("disabled",r.historyIndex<0||r.historyIndex>=r.history.length-1))}})}}changeView(e,n){if(!this._destroyed&&this._scheme){var i=this._find("FileView");i.set("type",e,!!n),n&&this._app._setSetting("ViewType",e,!0)}}toggleSidebar(e,n){if(this._destroyed||!this._scheme)return null;this.viewOptions.ViewSide=e;var i=this._find("SideContainer"),t=new h(i.$element.parentNode.querySelector("gui-paned-view-handle"));return e?(i.show(),t.show()):(i.hide(),t.hide()),n&&this._app._setSetting("ViewSide",e,!0),e}toggleVFSOption(e,n,i,t){if(this._destroyed||!this._scheme)return null;var a=this._find("FileView"),r=c.instance("VFS"),o={scandir:{}};return o.scandir[e]=i,r.set(null,o,null,t),a.set(n,i),i}toggleHidden(e,n){return this._destroyed||!this._scheme?null:this.toggleVFSOption("showHiddenFiles","dotfiles",e,n)}toggleExtension(e,n){return this._destroyed||!this._scheme?null:this.toggleVFSOption("showFileExtensions","extensions",e,n)}toggleNavbar(e,n){if(this._destroyed||!this._scheme)return null;this.viewOptions.ViewNavigation=e;var i=this._find("ToolbarContainer");return e?i.show():i.hide(),n&&this._app._setSetting("ViewNavigation",e,!0),e}toggleColumn(e,n){if(!this._destroyed&&this._scheme){var i=l.cloneObject(c.get("VFS")||{}),t=i.scandir||{},a=t.columns||["filename","mime","size"];if(e){var r=a.indexOf(e);r>=0?a.splice(r,1):a.push(e),t.columns=a,c.set("VFS","scandir",t,n)}var o=this._find("SubmenuView");o.set("checked","MenuColumnFilename",a.indexOf("filename")>=0),o.set("checked","MenuColumnMIME",a.indexOf("mime")>=0),o.set("checked","MenuColumnCreated",a.indexOf("ctime")>=0),o.set("checked","MenuColumnModified",a.indexOf("mtime")>=0),o.set("checked","MenuColumnSize",a.indexOf("size")>=0)}}}OSjs.Applications.ApplicationFileManager=class extends r{constructor(e,n){super("ApplicationFileManager",e,n)}init(e,n){super.init(...arguments);var i=this,t=this._getArgument("path")||p.getDefaultPath();this._on("vfs",function(e,n){var t=i._getMainWindow();t&&("vfs:mount"===e||"vfs:unmount"===e?t.onMountEvent(n,e):n.destination?(t.onFileEvent(n.destination,!0),t.onFileEvent(n.source)):t.onFileEvent(n))}),this._addWindow(new S(this,n,t,e))}download(e){e.length&&e.forEach(function(e){t.url(new a(e),{download:!0}).then(e=>window.open(e),{download:!0})})}rm(e,n){var i=this;if(e.length){var t=[];e.forEach(function(e){t.push(e.filename)}),t=t.join(", "),n._toggleDisabled(!0),u.create("Confirm",{buttons:["yes","no"],message:l.format(_("Delete **{0}** ?"),t)},function(t,r){n._toggleDisabled(!1),"ok"!==r&&"yes"!==r||e.forEach(function(e){e=new a(e),i._action("unlink",[e],function(){n.changePath(null)})})},n)}}info(e,n){e.length&&e.forEach(function(e){"file"===e.type&&u.create("FileInfo",{file:new a(e)},null,n)})}open(e){e.length&&e.forEach(function(e){"file"===e.type&&r.createFromFile(new a(e),{forceList:!0})})}rename(e,n){var t=this;e.length&&e.forEach(function(e){var r=u.create("Input",{message:_("Rename **{0}**",e.filename),value:e.filename},function(r,o,u){"ok"===o&&u&&function(e,r){e=new a(e);var o=new a(e);o.filename=r,o.path=i.replaceFilename(e.path,r),t._action("move",[e,o],function(e){e||n.changePath(null,o)})}(e,u)},n);r.setRange(i.getFilenameRange(e.filename))})}mkfile(e,n){var i=this;function r(e,a){n._toggleDisabled(!1),a&&t.write(a,"",{},i).then(()=>n.changePath(null,a))}n._toggleDisabled(!0),u.create("Input",{value:"My new File",message:_("Create a new file in **{0}**",e)},function(o,s,l){if(!l)return void n._toggleDisabled(!1);var c=new a(e+"/"+l);t.exists(c).then(e=>e(!1,l)).catch((e,t)=>{t?(n._toggleDisabled(!0),u.create("Confirm",{buttons:["yes","no"],message:d._("DIALOG_FILE_OVERWRITE",c.filename)},function(e,n){r("yes"===n||"ok"===n,c)},i)):r(!0,c)})},n)}mkdir(e,n){var t=this;n._toggleDisabled(!0),u.create("Input",{message:_("Create a new directory in **{0}**",e)},function(r,o,u){if(u){var d=new a(i.pathJoin(e,u));t._action("mkdir",[d],function(){n._toggleDisabled(!1),n.changePath(null,d)})}else n._toggleDisabled(!1)},n)}copy(e,n,i){var a=this,r=u.create("FileProgress",{message:_("Copying **{0}** to **{1}**",e.filename,n.path)},function(){},i);i._toggleLoading(!0);const o=e=>{i._toggleLoading(!1);try{r._close()}catch(e){}e&&OSjs.error(d._("ERR_GENERIC_APP_FMT",a.__label),d._("ERR_GENERIC_APP_REQUEST"),e)};t.copy(e,n,{dialog:r},this._app).then(()=>o(!1)).catch(o)}upload(e,n,i){var t=this;n?function(){function a(e,n){i._toggleLoading(!1),e&&OSjs.error(d._("ERR_GENERIC_APP_FMT",t.__label),d._("ERR_GENERIC_APP_REQUEST"),e)}i._toggleLoading(!0),n?Promise.each(n,n=>new Promise((i,a)=>{v({file:n,destination:e},function(e){e?a(e):i()},t)})).then(e=>a(null,e)).catch(a):v({destination:e},a,t)}():u.create("FileUpload",{dest:e},function(e,n,t){t&&i.changePath(null,t)},i)}showStorageNotification(e){C[e]||(C[e]=!0,w.create({title:"External Storage",message:"Using external services requires authorization. A popup-window may appear.",icon:y.getIcon("status/dialog-information.png","32x32")}))}_action(e,n,i){i=i||function(){},t[e].apply(t,n.concat(null,this)).then(e=>i(!1,e)).catch(e=>{OSjs.error(d._("ERR_GENERIC_APP_FMT",this.__label),d._("ERR_GENERIC_APP_REQUEST"),e),i(e)})}}}),e("osjs-apps-filemanager",["osjs-apps-filemanager/main"],function(e){return e})}(i),!t){var o=require("skylark-langx/skylark");a?module.exports=o:n.skylarkjs=o}}(0,this);
//# sourceMappingURL=sourcemaps/osjs-apps-filemanager-all.js.map
