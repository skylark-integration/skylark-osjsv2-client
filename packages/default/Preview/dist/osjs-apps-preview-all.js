/**
 * osjs-apps-preview - 
 * @author 
 * @version v1.0.0
 * @link 
 * @license 
 */
!function(i,t){var e=t.define,require=t.require,n="function"==typeof e&&e.amd,o=!n&&"undefined"!=typeof exports;if(!n&&!e){var r={};e=t.define=function(i,t,e){"function"==typeof e?(r[i]={factory:e,deps:t.map(function(t){return function(i,t){if("."!==i[0])return i;var e=t.split("/"),n=i.split("/");e.pop();for(var o=0;o<n.length;o++)"."!=n[o]&&(".."==n[o]?e.pop():e.push(n[o]));return e.join("/")}(t,i)}),resolved:!1,exports:null},require(i)):r[i]={factory:null,resolved:!0,exports:e}},require=t.require=function(i){if(!r.hasOwnProperty(i))throw new Error("Module "+i+" has not been defined");var module=r[i];if(!module.resolved){var e=[];module.deps.forEach(function(i){e.push(require(i))}),module.exports=module.factory.apply(t,e)||null,module.resolved=!0}return module.exports}}if(!e)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(i,require){i("osjs-apps-preview/scheme.html",[],function(){return'<application-window data-id="PreviewWindow">\r\n\r\n  <gui-vbox>\r\n    \x3c!-- MENU BAR --\x3e\r\n    <gui-vbox-container data-grow="0" data-shrink="1" data-basis="auto">\r\n      <gui-menu-bar>\r\n\r\n        <gui-menu-bar-entry data-label="LBL_FILE">\r\n          <gui-menu data-id="SubmenuFile">\r\n            <gui-menu-entry data-id="MenuOpen" data-label="LBL_OPEN"></gui-menu-entry>\r\n            <gui-menu-entry data-id="MenuOpenLocation" data-label="LBL_OPEN_LOCATION"></gui-menu-entry>\r\n            <gui-menu-entry data-id="MenuClose" data-label="LBL_CLOSE"></gui-menu-entry>\r\n          </gui-menu>\r\n        </gui-menu-bar-entry>\r\n\r\n      </gui-menu-bar>\r\n    </gui-vbox-container>\r\n\r\n    \x3c!-- TOOLBAR --\x3e\r\n    <gui-vbox-container data-grow="0" data-shrink="1" data-basis="auto" data-id="Toolbar">\r\n      <gui-toolbar>\r\n        <gui-button data-id="ZoomOriginal" data-icon="stock://16x16/actions/zoom-original.png"></gui-button>\r\n        <gui-button data-id="ZoomFit" data-icon="stock://16x16/actions/zoom-fit-best.png"></gui-button>\r\n        <gui-button data-id="ZoomOut" data-icon="stock://16x16/actions/zoom-out.png"></gui-button>\r\n        <gui-button data-id="ZoomIn" data-icon="stock://16x16/actions/zoom-in.png"></gui-button>\r\n      </gui-toolbar>\r\n    </gui-vbox-container>\r\n\r\n    \x3c!-- CONTENT --\x3e\r\n    <gui-vbox-container data-grow="1" data-shrink="0" data-basis="auto" data-fill="true">\r\n      <gui-container data-id="Content">\r\n      </gui-container>\r\n    </gui-vbox-container>\r\n\r\n  </gui-vbox>\r\n\r\n\r\n</application-window>\r\n'}),i("osjs-apps-preview/main",["./scheme.html"],function(i){const t=OSjs.require("utils/dom"),e=OSjs.require("utils/events"),n=OSjs.require("core/dialog"),o=OSjs.require("core/locales"),r=OSjs.require("core/connection"),s=OSjs.require("vfs/file"),a=OSjs.require("helpers/default-application"),u=OSjs.require("helpers/default-application-window");class l extends u{constructor(i,t,e){super("ApplicationPreviewWindow",{allow_drop:!0,icon:t.icon,title:t.name,width:400,height:200},i,e),this.zoomLevel=0,this.isImage=!0,this.origWidth=0,this.origHeight=0,this.$view=null}destroy(){return this.$view=null,super.destroy(...arguments)}init(t,a){var u=this;const l=super.init(...arguments);this._render("PreviewWindow",i),this._find("ZoomIn").son("click",this,this.onZoomIn),this._find("ZoomOut").son("click",this,this.onZoomOut),this._find("ZoomFit").son("click",this,this.onZoomFit),this._find("ZoomOriginal").son("click",this,this.onZoomOriginal),this._find("SubmenuFile").on("select",function(i){"MenuOpenLocation"===i.detail.id&&n.create("Input",{value:"http://"},function(i,t,e){if("ok"===t){if(!e.match(/^http/))return void u._setWarning(o._("ERR_OPEN_LOCATION_FMT",o._("ERR_INVALID_LOCATION")));r.request("curl",{method:"HEAD",url:e},function(i,t){var n=t.headers["content-type"];n||(i=o._("ERR_VFS_NO_MIME_DETECT")),i?u._setWarning(o._("ERR_OPEN_LOCATION_FMT",i)):u.showFile(new s(e,n),e)})}},{parent:u,modal:!0})});var h=this._find("Content").$element;return e.$bind(h,"mousewheel",function(i,t){1===t.z?u.onZoomOut():-1===t.z&&u.onZoomIn()}),l}showFile(i,e){var n=this,o=this._find("Content").$element;t.$empty(o),e&&(this.zoomLevel=0,i.mime.match(/^image/)?(this.isImage=!0,this.$view=this._create("gui-image",{src:e},o,{onload:function(){n.origWidth=this.offsetWidth,n.origHeight=this.offsetHeight,n._resizeTo(this.offsetWidth,this.offsetHeight,!0,!1,this)}})):i.mime.match(/^video/)&&(this.isImage=!1,this.$view=this._create("gui-video",{src:e,controls:!0,autoplay:!0},o,{onload:function(){n._resizeTo(this.offsetWidth,this.offsetHeight,!0,!1,this)}})));var r=this._find("Toolbar");r&&r[this.isImage?"show":"hide"](),super.showFile(...arguments)}_onZoom(i){if(this.isImage&&this.$view){var t=-1!==["in","out"].indexOf(i),e="zoomed",n=null;if("in"===i?this.zoomLevel=Math.min(10,this.zoomLevel+1):"out"===i?this.zoomLevel=Math.max(-10,this.zoomLevel-1):(this.zoomLevel=0,e="fit"===i?i:""),t){var o=this.zoomLevel;0===o?(o=1,n=this.origWidth):o>0?(o+=1,n=this.origWidth*o):o<0&&(o-=1,n=Math.abs(this.origWidth/o)),this._setTitle(this.currentFile.filename+" ("+String(100*o)+"%)",!0)}else this._setTitle(this.currentFile.filename,!0);this.$view.$element.setAttribute("data-zoom",e),this.$view.$element.firstChild.style.width=null===n?"auto":String(n)+"px"}}onZoomIn(){this._onZoom("in")}onZoomOut(){this._onZoom("out")}onZoomFit(){this._onZoom("fit")}onZoomOriginal(){this._onZoom()}}OSjs.Applications.ApplicationPreview=class extends a{constructor(i,t){super("ApplicationPreview",i,t,{readData:!1})}init(i,t){super.init(...arguments);const e=this._getArgument("file");this._addWindow(new l(this,t,e))}}}),i("osjs-apps-preview",["osjs-apps-preview/main"],function(i){return i})}(e),!n){var s=require("skylark-langx/skylark");o?module.exports=s:t.skylarkjs=s}}(0,this);
//# sourceMappingURL=sourcemaps/osjs-apps-preview-all.js.map
