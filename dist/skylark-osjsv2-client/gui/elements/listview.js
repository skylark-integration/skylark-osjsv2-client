/**
 * skylark-osjsv2-client - A version of osjs-client that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-osjsv2-client/
 * @license MIT
 */
define(["../../utils/dom","../../utils/gui","../../utils/events","../dataview"],function(e,t,i,l){"use strict";function r(i){const l=i.querySelector("gui-list-view-fake-head gui-list-view-head");e.$empty(l);const r=i.querySelector("gui-list-view-head gui-list-view-row");r&&(l.appendChild(r.cloneNode(!0)),function(){const l=i.querySelector("gui-list-view-fake-head"),r=i.querySelector("gui-list-view-head"),s=l.querySelectorAll("gui-list-view-column"),n=r.querySelectorAll("gui-list-view-column");l.querySelectorAll("gui-list-view-column-resizer").forEach(t=>{e.$remove(t)}),n.forEach((l,r)=>{if("true"===l.getAttribute("data-resizable")){const n=s[r],u=document.createElement("gui-list-view-column-resizer");n.appendChild(u);let o=0,c=0,d=16,a=d,g=null;t.createDrag(u,e=>{o=l.offsetWidth,a=d,c=i.offsetWidth-i.children.length*d},(t,i)=>{const r=o-i.x;!isNaN(r)&&r>a&&r<c&&(l.style.width=String(r)+"px",n.style.width=String(r)+"px"),g=e.$remove(g)})}})}())}function s(t,i){const l=t.$element;i.querySelectorAll("gui-list-view-column").forEach((t,i)=>{const r=t.getAttribute("data-icon");r&&"null"!==r&&(e.$addClass(t,"gui-has-image"),t.style.backgroundImage="url("+r+")");const s=t.firstChild;if(s&&3===s.nodeType){const e=document.createElement("span");e.appendChild(document.createTextNode(s.nodeValue)),t.insertBefore(e,s),t.removeChild(s)}l._columns[i]&&!l._columns[i].visible&&(t.style.display="none"),t.setAttribute("role","listitem")}),t.bindEntryEvents(i,"gui-list-view-row")}function n(e,i,l){const r=i.label||"";i.label&&delete i.label;let s=null;i.size&&(s=i.size,delete i.size);const n=t.createElement("gui-list-view-column",i);if(s&&(n.style.width=s),"function"==typeof r)n.appendChild(r.call(n,n,i));else{const e=document.createElement("span");e.appendChild(document.createTextNode(r)),n.appendChild(e)}return n}function u(e,i){if((i=i||{}).columns){const e=t.createElement("gui-list-view-row",i,["columns"]);return i.columns.forEach(t=>{e.appendChild(n(0,t))}),e}return null}return{GUIListView:class extends l{static register(){return super.register({parent:l,tagName:"gui-list-view"},this)}values(){const e=this.$element.querySelector("gui-list-view-body");return this.getSelected(e.querySelectorAll("gui-list-view-row"))}get(e,t,i,l){if("entry"===e){const e=this.$element.querySelector("gui-list-view-body").querySelectorAll("gui-list-view-row");return this.getEntry(e,t,i,l)}return super.get(...arguments)}set(t,i,l,s){const u=this.$element;if("columns"===t){const t=u.querySelector("gui-list-view-head"),l=document.createElement("gui-list-view-row");return e.$empty(t),u._columns=[],i.forEach(e=>{e.visible=void 0===e.visible||!0===e.visible;const t=n(0,e);u._columns.push(e),e.visible||(t.style.display="none"),l.appendChild(t)}),t.appendChild(l),r(u),this}if("selected"===t||"value"===t){const e=u.querySelector("gui-list-view-body");return this.setSelected(e,e.querySelectorAll("gui-list-view-row"),i,l,s),this}return super.set(...arguments)}add(e){const t=this.$element.querySelector("gui-list-view-body");return super.add(e,(e,i)=>{const l=i.onCreated||function(){},r=u(0,i);r&&(t.appendChild(r),s(this,r)),l(r)})}clear(){const e=this.$element.querySelector("gui-list-view-body");return super.clear(e)}remove(e){const t=this.$element.querySelector("gui-list-view-body");return super.remove(e,"gui-list-view-row",null,t)}patch(e){const t=this.$element.querySelector("gui-list-view-body");return super.patch(e,"gui-list-view-row",t,u,s)}build(){const e=this.$element;e._columns=[];let t=e.querySelector("gui-list-view-inner"),l=e.querySelector("gui-list-view-head"),n=e.querySelector("gui-list-view-body");function u(e){"GUI-LIST-VIEW-INNER"!==e.parentNode.tagName&&t.appendChild(e)}let o=e.querySelector("gui-list-view-fake-head");if(!o){o=document.createElement("gui-list-view-fake-head");const e=document.createElement("gui-list-view-inner");e.appendChild(document.createElement("gui-list-view-head")),o.appendChild(e)}return t||(t=document.createElement("gui-list-view-inner"),e.appendChild(t)),n?u(n):(n=document.createElement("gui-list-view-body"),t.appendChild(n)),n.setAttribute("role","group"),l?u(l):(l=document.createElement("gui-list-view-head"),t.insertBefore(l,n)),l.setAttribute("role","group"),e.setAttribute("role","list"),e.appendChild(o),i.$bind(e,"scroll",t=>{o.style.top=e.scrollTop+"px"},!1),e.querySelectorAll("gui-list-view-head gui-list-view-column").forEach((t,i)=>{const l=t.getAttribute("data-visible"),r={visible:null===l||"true"===l,size:t.getAttribute("data-size")};r.size&&(t.style.width=r.size),e._columns.push(r),r.visible||(t.style.display="none")}),r(e),e.querySelectorAll("gui-list-view-body gui-list-view-row").forEach(e=>{s(this,e)}),super.build(...arguments)}}}});
//# sourceMappingURL=../../sourcemaps/gui/elements/listview.js.map
