/**
 * skylark-osjsv2-client - A version of osjs-client that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-osjsv2-client/
 * @license MIT
 */
define(["../core/window"],function(i){"use strict";let s=0;return class extends i{constructor(i,s,t){super("IFrameApplicationWindow",s=Object.assign({},{src:"about:blank",focus:function(){},blur:function(){},icon:null,title:"IframeApplicationWindow",width:320,height:240,allow_resize:!1,allow_restore:!1,allow_maximize:!1},s),t),this._iwin=null,this._frame=null}destroy(){return this.postMessage("Window::destroy"),super.destroy(...arguments)}init(i,t){const e=super.init(...arguments);e.style.overflow="visible";const o="IframeApplicationWindow"+s.toString(),n=document.createElement("iframe");n.setAttribute("border",0),n.id=o,n.className="IframeApplicationFrame",n.addEventListener("load",()=>{this._iwin=n.contentWindow,this.postMessage("Window::init")}),this.setLocation(this._opts.src,n),e.appendChild(n),this._frame=n;try{this._iwin=n.contentWindow}catch(i){}return this._iwin&&this._iwin.focus(),this._frame.focus(),this._opts.focus(this._frame,this._iwin),s++,e}_blur(){return!!super._blur(...arguments)&&(this._iwin&&this._iwin.blur(),this._frame&&this._frame.blur(),this._opts.blur(this._frame,this._iwin),!0)}_focus(){return!!super._focus(...arguments)&&(this._iwin&&this._iwin.focus(),this._frame&&this._frame.focus(),this._opts.focus(this._frame,this._iwin),!0)}postMessage(i){this._iwin&&this._app&&(console.debug("IFrameApplicationWindow::postMessage()",i),this._iwin.postMessage({message:i,pid:this._app.__pid,wid:this._wid},window.location.href))}onPostMessage(i,s){console.debug("IFrameApplicationWindow::onPostMessage()",i)}setLocation(i,s){s=s||this._frame;const t=window.onbeforeunload;window.onbeforeunload=null,s.src=i,window.onbeforeunload=t}}});
//# sourceMappingURL=../sourcemaps/helpers/iframe-application-window.js.map
