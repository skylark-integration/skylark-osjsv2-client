/**
 * skylark-osjsv2-client - A version of osjs-client that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-osjsv2-client/
 * @license MIT
 */
define(["../vfs/file","../core/window","../core/dialog","../core/locales"],function(e,i,t,s){"use strict";return class extends i{constructor(i,t,s,n){super(...arguments),this.hasClosingDialog=!1,this.currentFile=n?new e(n):null,this.hasChanged=!1}destroy(){super.destroy(...arguments),this.currentFile=null}init(e,i){return super.init(...arguments)}_inited(){const e=i.prototype._inited.apply(this,arguments),t=this._app,s={MenuNew:()=>{t.newDialog(this.currentFile,this)},MenuSave:()=>{t.saveDialog(this.currentFile,this)},MenuSaveAs:()=>{t.saveDialog(this.currentFile,this,!0)},MenuOpen:()=>{t.openDialog(this.currentFile,this)},MenuClose:()=>{this._close()}};return this._find("SubmenuFile").on("select",e=>{s[e.detail.id]&&s[e.detail.id]()}),this._find("MenuSave").set("disabled",!0),this.currentFile&&(this._app.openFile(this.currentFile,this)||(this.currentFile=null)),e}_onDndEvent(t,s,n,h){if(i.prototype._onDndEvent.apply(this,arguments)&&"itemDrop"===s&&n){const i=n.data;i&&"file"===i.type&&i.mime&&this._app.openFile(new e(i),this)}}_close(){if(!this.hasClosingDialog)return this.hasChanged?(this.hasClosingDialog=!0,void this.checkHasChanged(e=>{this.hasClosingDialog=!1,e&&(this.hasChanged=!1,this._close())})):void i.prototype._close.apply(this,arguments)}checkHasChanged(e){this.hasChanged?t.create("Confirm",{buttons:["yes","no"],message:s._("MSG_GENERIC_APP_DISCARD")},function(i,t){e("ok"===t||"yes"===t)},{parent:this,modal:!0}):e(!0)}showFile(e,i){this.updateFile(e)}updateFile(e){this.currentFile=e||null,this.hasChanged=!1,this._scheme&&this._find("MenuSave").set("disabled",!e),e?this._setTitle(e.filename,!0):this._setTitle()}getFileData(){return null}_onKeyEvent(e,t,s){return"SAVE"===s?(this._app.saveDialog(this.currentFile,this,!this.currentFile),!1):"SAVEAS"===s?(this._app.saveDialog(this.currentFile,this,!0),!1):"OPEN"===s?(this._app.openDialog(this.currentFile,this),!1):i.prototype._onKeyEvent.apply(this,arguments)}}});
//# sourceMappingURL=../sourcemaps/helpers/default-application-window.js.map
